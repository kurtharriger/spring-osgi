<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE preface PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
                 "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd">
<appendix id="appendix-extensions">
    <title>Extensions</title>

    <para>This appendix describes extensions to the core functionality that
    are shipped with the 1.0 distribution, but are not guaranteed to have
    backwards compatibility across point releases. We anticipate these
    features migrating into the core specification in future releases.</para>

    <section id="appendix-extensions:annotations">
      <title>Annotation-based injection</title>

      <para>The
      <literal>org.springframework.osgi.extensions.annotation</literal> bundle
      that ships with Spring Dynamic Modules provides early access to
      annotation-based support for injecting references to OSGi services. JDK
      1.5 or above is required to use this feature.</para>

      <para>Bean class (setter) methods may be annotated with
      <literal>org.springframework.osgi.extensions.annotation.ServiceReference</literal>.
      By default the property type of the annotated property is used to look
      up a service with a matching service interface in the OSGi service
      registry and inject the result. For example, given the
      configuration:</para>

      <programlisting><![CDATA[<bean id="annotationDriven" class="MyAnnotationDrivenBeanClass"/>
      ]]></programlisting>

      <para>and the class declaration:</para>

      <programlisting language="java"><![CDATA[public class MyAnnotationDrivenBeanClass {

  @ServiceReference
  public void setMessageService(MessageService aService) { ... }

}]]></programlisting>

      <para>then a service lookup for services implementing the
      <interfacename>MessageService</interfacename> interface will be performed, and the
      best match (using the same algorithm as documented for the
      <literal>reference</literal> element) will be injected.</para>

      <para>The <classname>ServiceReference</classname> annotation class has a
      number of attributes that can be used to control the service lookup (for
      example, to specify a filter string) that mirror the options provided by
      the <literal>reference</literal> element. See the javadoc for more
      information.</para>
    </section>
</appendix>
